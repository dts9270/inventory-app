<!doctype html>
<html lang="mr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>рд╕рд╛рдорд╛рди рд╡реНрдпрд╡рд╕реНрдерд╛рдкрди (Marathi Inventory)</title>

<!-- Tailwind -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- Firebase v9 -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>

<style>
body{font-family:sans-serif;background:#faf7ef}
.card{border-radius:12px;box-shadow:0 4px 10px rgba(0,0,0,0.10);background:white}
.big{font-size:20px;font-weight:700}
</style>
</head>
<body class="p-4">

<h1 class="text-center text-3xl font-bold mb-4">ЁЯУж рд╕рд╛рдорд╛рди рд╡реНрдпрд╡рд╕реНрдерд╛рдкрди</h1>

<!-- Tabs -->
<div class="flex gap-2 mb-4">
    <button id="tabIn" class="flex-1 p-3 bg-amber-600 text-white rounded big">IN (рдШреЗрдгреЗ)</button>
    <button id="tabOut" class="flex-1 p-3 bg-gray-300 rounded big">OUT (рджреЗрдгреЗ)</button>
    <button id="tabReports" class="flex-1 p-3 bg-gray-300 rounded big">ЁЯУК рд░рд┐рдкреЛрд░реНрдЯ</button>
</div>

<!-- IN Panel -->
<div id="panelIn" class="card p-4">
    <h2 class="text-xl font-semibold mb-3">IN тАФ рд╕рд╛рдорд╛рди рдШреЗрддрд▓реЗ</h2>

    <label>рддрд╛рд░реАрдЦ</label>
    <input id="inDate" type="date" class="w-full p-2 border rounded mb-3">

    <label>рдХреЛрдгрд╛рдХрдбреВрди</label>
    <input id="inFrom" type="text" placeholder="рдкреБрд░рд╡рдард╛рджрд╛рд░" class="w-full p-2 border rounded mb-3">

    <div class="grid grid-cols-2 gap-3">
        <div>
            <label>рдПрдХреВрдг рд░рдХреНрдХрдо (тВ╣)</label>
            <input id="inTotal" type="number" class="w-full p-2 border rounded">
        </div>
        <div>
            <label>рднрд░рд▓реЗ (тВ╣)</label>
            <input id="inPaid" type="number" class="w-full p-2 border rounded">
        </div>
    </div>

    <label class="mt-3">рдкреЗрдореЗрдВрдЯ рдкреНрд░рдХрд╛рд░</label>
    <select id="inPayType" class="w-full p-2 border rounded mb-3">
        <option>Cash</option>
        <option>Online</option>
        <option>Baki</option>
    </select>

    <label>рдмрд┐рд▓ / рдлреЛрдЯреЛ</label>
    <input id="inFile" type="file" class="w-full p-2 border rounded mb-3">

    <button id="btnIn" class="w-full p-3 bg-amber-600 text-white rounded big">IN рдЬрддрди рдХрд░рд╛</button>

    <h3 class="text-lg mt-4 font-semibold">рддрд╛рдЬреНрдпрд╛ IN рдиреЛрдВрджреА</h3>
    <div id="recentIn" class="text-gray-700"></div>
</div>

<!-- OUT Panel -->
<div id="panelOut" class="card p-4 hidden">
    <h2 class="text-xl font-semibold mb-3">OUT тАФ рд╕рд╛рдорд╛рди рджрд┐рд▓реЗ</h2>

    <label>рддрд╛рд░реАрдЦ</label>
    <input id="outDate" type="date" class="w-full p-2 border rounded mb-3">

    <label>рдХреЛрдгрд╛рд▓рд╛</label>
    <input id="outTo" type="text" placeholder="рдЧреНрд░рд╛рд╣рдХ" class="w-full p-2 border rounded mb-3">

    <div class="grid grid-cols-2 gap-3">
        <div>
            <label>рдПрдХреВрдг рд░рдХреНрдХрдо (тВ╣)</label>
            <input id="outTotal" type="number" class="w-full p-2 border rounded">
        </div>
        <div>
            <label>рднрд░рд▓реЗ (тВ╣)</label>
            <input id="outPaid" type="number" class="w-full p-2 border rounded">
        </div>
    </div>

    <label class="mt-3">рдкреЗрдореЗрдВрдЯ рдкреНрд░рдХрд╛рд░</label>
    <select id="outPayType" class="w-full p-2 border rounded mb-3">
        <option>Cash</option>
        <option>Online</option>
        <option>Baki</option>
    </select>

    <label>рдмрд┐рд▓ / рдлреЛрдЯреЛ</label>
    <input id="outFile" type="file" class="w-full p-2 border rounded mb-3">

    <button id="btnOut" class="w-full p-3 bg-blue-600 text-white rounded big">OUT рдЬрддрди рдХрд░рд╛</button>

    <h3 class="text-lg mt-4 font-semibold">рддрд╛рдЬреНрдпрд╛ OUT рдиреЛрдВрджреА</h3>
    <div id="recentOut" class="text-gray-700"></div>
</div>

<!-- REPORT Panel -->
<div id="panelReports" class="card p-4 hidden">
    <h2 class="text-xl font-semibold mb-3">ЁЯУК рдПрдХрддреНрд░рд┐рдд рд░рд┐рдкреЛрд░реНрдЯ</h2>
    <button id="loadReport" class="w-full p-3 bg-green-600 text-white rounded big">рд░рд┐рдкреЛрд░реНрдЯ рд▓реЛрдб рдХрд░рд╛</button>
    <div id="reportBox" class="mt-4"></div>
</div>

<script>
// ---------------- FIREBASE CONFIG ----------------
const firebaseConfig = {
  apiKey: "AIzaSyA3PdBavWlcE3w3Ojgy0yk2jKAUfCuAbY",
  authDomain: "product-buy-sell.firebaseapp.com",
  projectId: "product-buy-sell",
  storageBucket: "product-buy-sell.appspot.com",
};
firebase.initializeApp(firebaseConfig);

const db = firebase.firestore();
const storage = firebase.storage();

// ---------------- SIMPLE FUNCTIONS ----------------
function toast(t){ alert(t); }

// Upload File
async function uploadFile(file, folder){
  if(!file) return "";
  const path = `${folder}/${Date.now()}_${file.name}`;
  const ref = storage.ref(path);
  await ref.put(file);
  return await ref.getDownloadURL();
}

// ---------------- SAVE IN ----------------
document.getElementById("btnIn").onclick = async () =>{
 try{
    const obj = {
      date: inDate.value,
      from: inFrom.value.trim(),
      total: Number(inTotal.value)||0,
      paid: Number(inPaid.value)||0,
      balance: (Number(inTotal.value)-Number(inPaid.value)),
      payType: inPayType.value,
      createdAt: Date.now()
    };
    obj.fileURL = await uploadFile(inFile.files[0],"in");
    await db.collection("in_entries").add(obj);
    toast("IN рдЬрддрди рдЭрд╛рд▓реЗ!");
    loadRecent();
 }catch(err){ toast("IN Error: "+err); }
};

// ---------------- SAVE OUT ----------------
document.getElementById("btnOut").onclick = async () =>{
 try{
    const obj = {
      date: outDate.value,
      to: outTo.value.trim(),
      total: Number(outTotal.value)||0,
      paid: Number(outPaid.value)||0,
      balance: (Number(outTotal.value)-Number(outPaid.value)),
      payType: outPayType.value,
      createdAt: Date.now()
    };
    obj.fileURL = await uploadFile(outFile.files[0],"out");
    await db.collection("out_entries").add(obj);
    toast("OUT рдЬрддрди рдЭрд╛рд▓реЗ!");
    loadRecent();
 }catch(err){ toast("OUT Error: "+err); }
};

// ---------------- RECENT LOAD ----------------
async function loadRecent(){
 let box="";
 const snap = await db.collection("in_entries").orderBy("createdAt","desc").limit(5).get();
 snap.forEach(d=> box+=`<div class="border p-2 mb-1">IN: тВ╣${d.data().total} (${d.data().from})</div>`);
 recentIn.innerHTML = box;

 box="";
 const snap2 = await db.collection("out_entries").orderBy("createdAt","desc").limit(5).get();
 snap2.forEach(d=> box+=`<div class="border p-2 mb-1">OUT: тВ╣${d.data().total} (${d.data().to})</div>`);
 recentOut.innerHTML = box;
}
loadRecent();

// ---------------- REPORT ----------------
document.getElementById("loadReport").onclick = async ()=>{
 let box = "<h3 class='font-bold mb-2'>рд╕рдВрдкреВрд░реНрдг рд░рд┐рдкреЛрд░реНрдЯ</h3>";
 const ins = await db.collection("in_entries").get();
 const outs = await db.collection("out_entries").get();

 let inSum=0,outSum=0;
 ins.forEach(d=> inSum += d.data().balance);
 outs.forEach(d=> outSum += d.data().balance);

 box += `<div class='p-2 border mb-2'>IN рдмрд╛рдХреА: тВ╣${inSum}</div>`;
 box += `<div class='p-2 border mb-2'>OUT рдмрд╛рдХреА: тВ╣${outSum}</div>`;
 reportBox.innerHTML = box;
};

// ---------------- TAB SWITCH ----------------
tabIn.onclick = ()=>{
 tabIn.className="flex-1 p-3 bg-amber-600 text-white rounded big";
 tabOut.className="flex-1 p-3 bg-gray-300 rounded big";
 tabReports.className="flex-1 p-3 bg-gray-300 rounded big";
 panelIn.classList.remove("hidden");
 panelOut.classList.add("hidden");
 panelReports.classList.add("hidden");
};
tabOut.onclick = ()=>{
 tabOut.className="flex-1 p-3 bg-blue-600 text-white rounded big";
 tabIn.className="flex-1 p-3 bg-gray-300 rounded big";
 tabReports.className="flex-1 p-3 bg-gray-300 rounded big";
 panelOut.classList.remove("hidden");
 panelIn.classList.add("hidden");
 panelReports.classList.add("hidden");
};
tabReports.onclick = ()=>{
 tabReports.className="flex-1 p-3 bg-green-600 text-white rounded big";
 tabIn.className="flex-1 p-3 bg-gray-300 rounded big";
 tabOut.className="flex-1 p-3 bg-gray-300 rounded big";
 panelReports.classList.remove("hidden");
 panelIn.classList.add("hidden");
 panelOut.classList.add("hidden");
};
</script>
</body>
</html>
